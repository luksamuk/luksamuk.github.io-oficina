<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OficinaFramework: IronLua API Reference v0.1.5b</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OficinaFramework
   &#160;<span id="projectnumber">2.0.12</span>
   </div>
   <div id="projectbrief">OficinaFramework is an easy-to-use and dynamic C++ game engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('luaref.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">IronLua API Reference v0.1.5b </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Quick API reference for IronLua.</p>
<h1><a class="anchor" id="luageneral"></a>
General Lua Syntax</h1>
<p>IronLua is an implementation of Lua 5.3 for OficinaFramework. Its goal is to fullfill the need for an object scripting language for Oficina, as well as a language for Oficina's REPL. While it's not always possible to use IronScheme on some platforms, Lua is a wide-support scripting language, featuring minimalist implementation, and can fulfill the need for a scripting language where GNU Guile may fall short.</p>
<h1><a class="anchor" id="luaspecific"></a>
IronLua Specific Syntax</h1>
<h2><a class="anchor" id="luaglobal"></a>
Global symbols</h2>
<p>These symbols are available for use on all scripts, and should be used when necessary. All sequential symbols are just aliases for integers; the first of each "collection" always represent the value 0, EXCEPT for the coordinate components, which start at 1, in conformance to Lua's 1-based approach to numbering.</p>
<h2>Players</h2>
<div class="fragment"><div class="line">PLAYER_ONE</div><div class="line">PLAYER_TWO</div><div class="line">PLAYER_THREE</div><div class="line">PLAYER_FOUR</div></div><!-- fragment --><h2>Gamepad Triggers</h2>
<div class="fragment"><div class="line">LEFT_TRIGGER</div><div class="line">RIGHT_TRIGGER</div></div><!-- fragment --><h2>Gamepad Buttons</h2>
<div class="fragment"><div class="line">PAD_START</div><div class="line">PAD_BACK</div><div class="line">PAD_A</div><div class="line">PAD_B</div><div class="line">PAD_X</div><div class="line">PAD_Y</div><div class="line">PAD_LS</div><div class="line">PAD_RS</div><div class="line">PAD_D_UP</div><div class="line">PAD_D_DOWN</div><div class="line">PAD_D_LEFT</div><div class="line">PAD_D_RIGHT</div><div class="line">PAD_LB</div><div class="line">PAD_LT</div><div class="line">PAD_RB</div><div class="line">PAD_RT</div></div><!-- fragment --><h2>Mouse Buttons</h2>
<div class="fragment"><div class="line">MOUSE_LEFT</div><div class="line">MOUSE_MID</div><div class="line">MOUSE_RIGHT</div></div><!-- fragment --><h2>Coordinate Components</h2>
<div class="fragment"><div class="line">X</div><div class="line">Y</div><div class="line">Z</div><div class="line">W</div></div><!-- fragment --><h2>Hardcoded Font Faces</h2>
<div class="fragment"><div class="line">TYPEFACE_FIXEDSYS</div><div class="line">TYPEFACE_GOHU</div><div class="line">TYPEFACE_FANTASQUE</div><div class="line">TYPEFACE_TERMINUS</div></div><!-- fragment --><h2><a class="anchor" id="luacommon"></a>
Oficina Common API</h2>
<p>All functions described here are available to all instantiated Lua scripts, be it the global Lua REPL (controlled by the oficina::ofLuaXXX C++ functions) or the object-based Lua script (<a class="el" href="classoficina_1_1of_lua.html" title="Defines one Lua environment to be used inside an entity. ">oficina::ofLua</a> class).</p>
<p>To access these functions, one must use the prefix common.</p>
<h3><a class="anchor" id="luaoutput"></a>
Output</h3>
<p>These functions will write or affect directly the debugger's REPL output.</p>
<h4><a class="anchor" id="ofluaFORMAT"></a>
format</h4>
<div class="fragment"><div class="line">common.format(format, ...)</div></div><!-- fragment --><p> Prints a formatted string to the REPL. Formatting works with an underlying call to string.format, in Lua's string library. </p><dl class="section note"><dt>Note</dt><dd>The format should follow the same rules as C's printf-like functions. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">format</td><td>String format to be used. </td></tr>
    <tr><td class="paramname">...</td><td>Any variables to be formatted, as long as they fit the input format string. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h4><a class="anchor" id="ofluaHEX"></a>
hex</h4>
<div class="fragment"><div class="line">common.hex(number)</div></div><!-- fragment --><p> Returns a string with a hexadecimal format of 0x00000000 for the given number. Ideal for representing memory pointers. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">number</td><td>Number to be formatted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A string containing the formatted number.</dd></dl>
<h4><a class="anchor" id="ofluaCLEAR"></a>
clear</h4>
<div class="fragment"><div class="line">common.clear()</div></div><!-- fragment --><p> Clears REPL's output. </p><dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h4><a class="anchor" id="ofluaCANVASLIST"></a>
canvasList</h4>
<div class="fragment"><div class="line">common.canvasList()</div></div><!-- fragment --><p> Shows information on currently loaded canvases. </p><dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h4><a class="anchor" id="ofluaQUIT"></a>
quit</h4>
<div class="fragment"><div class="line">common.quit()</div></div><!-- fragment --><p> Soft stops the entire engine and quits game. </p><dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h4><a class="anchor" id="ofluaSETFACE"></a>
setFace</h4>
<div class="fragment"><div class="line">common.setFace(typeface)</div></div><!-- fragment --><p> Changes the font typeface used on the debugger in general. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">typename</td><td>Enumeration specifying which typeface should be used. Possible values are TYPEFACE_FIXEDSYS, TYPEFACE_GOHU, TYPEFACE_FANTASQUE and TYPEFACE_TERMINUS. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h3><a class="anchor" id="luainput"></a>
Input</h3>
<p>These functions will get player-related input from game controllers and such.</p>
<h4><a class="anchor" id="ofluaLSTICK"></a>
lstick</h4>
<div class="fragment"><div class="line">common.lstick(player)</div></div><!-- fragment --><p> Gets player's left stick. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">player</td><td>(Optional) Player to be compared. Defaults to PLAYER_ONE if ignored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Lua table with two numeric coordinates ranging from -1.0 to 1.0.</dd></dl>
<h4><a class="anchor" id="ofluaRSTICK"></a>
rstick</h4>
<div class="fragment"><div class="line">common.rstick(player)</div></div><!-- fragment --><p> Gets player's right stick. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">player</td><td>(Optional) Player to be compared. Defaults to PLAYER_ONE if ignored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Lua table with two numeric coordinates ranging from -1.0 to 1.0.</dd></dl>
<h4><a class="anchor" id="ofluaTRIGGER"></a>
trigger</h4>
<div class="fragment"><div class="line">common.trigger(which, player)</div></div><!-- fragment --><p> Gets a controller's trigger pressing ratio value, for a specific player's controller. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">which</td><td>Specification for which trigger should be compared. You may use LEFT_TRIGGER or RIGHT_TRIGGER. </td></tr>
    <tr><td class="paramname">player</td><td>(Optional) Player to be compared. Defaults to PLAYER_ONE if ignored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A real value ranging from 0.0 to 1.0, depending on how much the trigger is being pressed.</dd></dl>
<h4><a class="anchor" id="ofluaBTNPRESS"></a>
btnpress</h4>
<div class="fragment"><div class="line">common.btnpress(which, player)</div></div><!-- fragment --><p> Gets whether a button is being held at a specific player's controller. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">which</td><td>Button to be compared. All values similar to PAD_START, PAD_BACK and etcetera may be used. </td></tr>
    <tr><td class="paramname">player</td><td>(Optional) Player to be compared. Defaults to PLAYER_ONE if ignored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the button is being held by the player or not.</dd></dl>
<h4><a class="anchor" id="ofluaBTNTAP"></a>
btntap</h4>
<div class="fragment"><div class="line">common.btntap(which, player)</div></div><!-- fragment --><p> Gets whether a button was pressed on the current frame. Different from common.btnpress, a common.btntap only lasts for a single frame. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">which</td><td>Button to be compared. All values similar to PAD_START, PAD_BACK and etcetera may be used. </td></tr>
    <tr><td class="paramname">player</td><td>(Optional) Player to be compared. Defaults to PLAYER_ONE if ignored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the button is being held by the player or not.</dd></dl>
<h4><a class="anchor" id="ofluaMOUSEPOS"></a>
mousepos</h4>
<div class="fragment"><div class="line">common.mousepos()</div></div><!-- fragment --><p> Gets the current mouse position. </p><dl class="section return"><dt>Returns</dt><dd>A table with two numeric values representing screen coordinates.</dd></dl>
<h4><a class="anchor" id="ofluaMOUSEPRESS"></a>
mousepress</h4>
<div class="fragment"><div class="line">common.mousepress(which)</div></div><!-- fragment --><p> Gets whether a mouse button is being held. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">which</td><td>Mouse button to be compared. May be MOUSE_LEFT, MOUSE_MID or MOUSE_RIGHT. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the mouse button is being pressed or not.</dd></dl>
<h4><a class="anchor" id="ofluaMOUSETAP"></a>
mousetap</h4>
<div class="fragment"><div class="line">common.mousetap(which)</div></div><!-- fragment --><p> Gets whether a mouse button was tapped on the current frame. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">which</td><td>Mouse button to be compared. May be MOUSE_LEFT, MOUSE_MID or MOUSE_RIGHT. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the mouse button was tapped or not.</dd></dl>
<h3><a class="anchor" id="luadisplay"></a>
Display</h3>
<p>Display-related functions to get useful information regarding screen size, etc.</p>
<h4><a class="anchor" id="ofluaVWPRT"></a>
vwprt</h4>
<div class="fragment"><div class="line">common.vwprt()</div></div><!-- fragment --><p> Gets the viewport size. </p><dl class="section return"><dt>Returns</dt><dd>A table of two numeric values containing the current viewport size.</dd></dl>
<h4><a class="anchor" id="ofluaSETFULLSCREEN"></a>
setFullscr</h4>
<div class="fragment"><div class="line">common.setFullscr(state)</div></div><!-- fragment --><p> Sets the fullscreen state of the global display. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>The new fullscreen state; Active (true) or not (false). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h4><a class="anchor" id="ofluaISFULLSCR"></a>
isFullscr</h4>
<div class="fragment"><div class="line">common.isFullscr()</div></div><!-- fragment --><p> Gets the fullscreen state of the global display. </p><dl class="section return"><dt>Returns</dt><dd>Whether the screen is in fullscreen state or not.</dd></dl>
<h2><a class="anchor" id="luaobject"></a>
Oficina Entity API</h2>
<p>These functions serve the purpose of object manipulation.</p>
<p>To access these functions, one must use the prefix entity.</p>
<h3><a class="anchor" id="luareferencing"></a>
Referencing objects</h3>
<p>Moust of these functions will use some of these resources or functions to refer to other objects. Each one holds/returns a handle to an object, which can be searched on the parent object collection.</p>
<h4><a class="anchor" id="ofluaTHIS"></a>
this</h4>
<div class="fragment"><div class="line"><span class="keyword">this</span></div></div><!-- fragment --><p> Lua userdata referencing the current object, the one which loaded the current script. Use this value to save searching time. Each object has a different value.</p>
<h3><a class="anchor" id="luaretriev_comps"></a>
Retrieving components</h3>
<p>These functions provide an interface to deal directly with an Entity's components. Said components, from the Scheme interface, will also retain the derived class' type saved on a string. Said type is deduced once the component is attached to an Entity, unless directly specified. For more info, see <a class="el" href="classoficina_1_1of_i_component.html" title="Defines a single component to be attached to an entity. ">oficina::ofIComponent</a>. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="classoficina_1_1of_i_component.html" title="Defines a single component to be attached to an entity. ">oficina::ofIComponent</a></dd></dl>
<h4><a class="anchor" id="ofluaGETCOMPONENT"></a>
getComponent</h4>
<div class="fragment"><div class="line">entity.getComponent(name, objref)</div></div><!-- fragment --><p> Retrieves a component from a specified entity or from this. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the component, as registered on the Entity. </td></tr>
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Lua userdata containing a reference to the component.</dd></dl>
<h4><a class="anchor" id="ofluaCOMPONENTTYPE"></a>
componentType</h4>
<div class="fragment"><div class="line">entity.componentType(compref)</div></div><!-- fragment --><p> Retrieves a string specifying the component's type. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">compref</td><td>Reference to the component. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A string containing the component's type, as deduced when registering said component.</dd></dl>
<h3><a class="anchor" id="luatransform"></a>
Object transformation</h3>
<p>Use this to change overall object's properties and matrices.</p>
<h4><a class="anchor" id="ofluaTRANSLATE"></a>
translate</h4>
<div class="fragment"><div class="line">entity.translate(coord, loadIdentity, objref)</div></div><!-- fragment --><p> Translates object to/by a coordinate. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">coord</td><td>Table with three numeric values, each representing a translation coordinate (X, Y and Z axis). </td></tr>
    <tr><td class="paramname">loadIdentity</td><td>(Optional) Whether the positioning matrix must be reset before positioning. Defaults to false. </td></tr>
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this.</td></tr>
  </table>
  </dd>
</dl>
<h4><a class="anchor" id="ofluaROTATE"></a>
rotate</h4>
<div class="fragment"><div class="line">entity.rotate(theta, axis, loadIdentity, objref)</div></div><!-- fragment --><p> Rotates object by an angle around a specified axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">theta</td><td>Angle of rotation, in radians. </td></tr>
    <tr><td class="paramname">axis</td><td>Table with three numeric values, each representing a rotation axis coordinate (X, Y and Z axis). </td></tr>
    <tr><td class="paramname">loadIdentity</td><td>(Optional) Whether the rotation matrix must be reset before positioning. Defaults to false. </td></tr>
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this.</td></tr>
  </table>
  </dd>
</dl>
<h4><a class="anchor" id="ofluaSCALE"></a>
scale</h4>
<div class="fragment"><div class="line">entity.scale(scl, loadIdentity, objref)</div></div><!-- fragment --><p> Scales object to/by an amount. </p><dl class="section note"><dt>Note</dt><dd>Scaling defaults to 1.0 on all three axis, so if you feel like resetting the scaling, simply scale all axis by 1.0 and set loadIdentity to true. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scl</td><td>Table with three numeric values describing scaling factors on X, Y and Z axis. Each axis defaults to 1.0. </td></tr>
    <tr><td class="paramname">loadIdentity</td><td>(Optional) Whether the scaling matrix must be reset before scaling. Different from other functions, defaults to true. </td></tr>
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this.</td></tr>
  </table>
  </dd>
</dl>
<h4><a class="anchor" id="ofluaGETPOS"></a>
getPosition</h4>
<div class="fragment"><div class="line">entity.getPosition(objref)</div></div><!-- fragment --><p> Gets an object's position. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A table containing two numeric values, representing the position of an object.</dd></dl>
<h4><a class="anchor" id="ofluaEULERANGLE"></a>
getEulerAngle</h4>
<div class="fragment"><div class="line">entity.getEulerAngle(axis, objref)</div></div><!-- fragment --><p> Gets the Euler angle related to a specific rotated axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>Desired axis coordinate (X, Y or Z) of rotation to reference. </td></tr>
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A numeric value containing the euler value of the desired axis.</dd></dl>
<h4><a class="anchor" id="ofluaMAG"></a>
getMagnification</h4>
<div class="fragment"><div class="line">entity.getMagnification(axis, objref)</div></div><!-- fragment --><p> Gets ratio of magnification (scaling) related to a specific coordinate axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>Desired axis coordinate (X, Y or Z) of magnification to reference. </td></tr>
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A real value containing the magnitude of the object on the desired axis.</dd></dl>
<h4><a class="anchor" id="ofluaSETPROP"></a>
setProperty</h4>
<div class="fragment"><div class="line">entity.setProperty(which, state, objref)</div></div><!-- fragment --><p> Sets a specific property to true or false. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">which</td><td>Property index, ranging from 1 to 32, as per Lua's 1-based numbering. </td></tr>
    <tr><td class="paramname">state</td><td>Active (true) or inactive (false). </td></tr>
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this.</td></tr>
  </table>
  </dd>
</dl>
<h4><a class="anchor" id="ofluaTOGPROP"></a>
toggleProperty</h4>
<div class="fragment"><div class="line">entity.toggleProperty(which, objref)</div></div><!-- fragment --><p> Toggles a specific property's state. Gets whether a property is active or inactive. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">which</td><td>Property index, ranging from 1 to 32, as per Lua's 1-based numbering. </td></tr>
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this.</td></tr>
  </table>
  </dd>
</dl>
<h4><a class="anchor" id="ofluaGETPROP"></a>
getProperty</h4>
<div class="fragment"><div class="line">entity.getProperty(which, objref)</div></div><!-- fragment --><p> Gets whether a property is active or inactive. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">which</td><td>Property index, ranging from 1 to 32, as per Lua's 1-based numbering. </td></tr>
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Boolean true or false, depending on the state of the property.</dd></dl>
<h4><a class="anchor" id="ofluaPROPMASK"></a>
getPropertyMask</h4>
<div class="fragment"><div class="line">entity.getPropertyMask(objref)</div></div><!-- fragment --><p> Gets the properties mask as an integer. Can be formatted with hex. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">objref</td><td>(Optional) Reference to object. Defaults to this. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An integer value containing the properties mask of an object.</dd></dl>
<h2><a class="anchor" id="luarendering"></a>
Oficina Rendering API</h2>
<p>These functions and methods provide interfaces for dealing directly with rendering. Some of them will require components of certain types as parameters, as they're basically clones of those components' methods. You can access these functions using the prefix render.</p>
<h3><a class="anchor" id="luarend"></a>
General Rendering API</h3>
<p>These methods should be used to modify the rendering canvas in a live fashion.</p>
<h4><a class="anchor" id="ofluaSETCLEARCOL"></a>
setClearColor</h4>
<div class="fragment"><div class="line">render.setClearColor(color)</div></div><!-- fragment --><p> Sets the background color when clearing the context on an update. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">color</td><td>Table containing four numeric values, expressing normalized values for RGBA, respectively. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h3><a class="anchor" id="luaanim"></a>
Animation API</h3>
<p>These methods are clones of most methods containing in <a class="el" href="classoficina_1_1of_animator.html" title="Tool for controlling a texture renderer to generate animations. ">oficina::ofAnimator</a> and, therefore, require a reference to an animator component as first parameter to work. All of those methods also require a prefix animator.</p>
<h4><a class="anchor" id="ofluaSETANIM"></a>
setAnimation</h4>
<div class="fragment"><div class="line">render.animator.setAnimation(animator, name)</div></div><!-- fragment --><p> Sets the current animation on the animator. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">animator</td><td>Reference to an <a class="el" href="classoficina_1_1of_animator.html" title="Tool for controlling a texture renderer to generate animations. ">oficina::ofAnimator</a> component. </td></tr>
    <tr><td class="paramname">name</td><td>String containing the name of the new animation to be played. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h4><a class="anchor" id="ofluaSETANIMSPD"></a>
setSpeed</h4>
<div class="fragment"><div class="line">render.animator.setSpeed(animator, speed)</div></div><!-- fragment --><p> Sets the current animation speed on the animator. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">animator</td><td>Reference to an <a class="el" href="classoficina_1_1of_animator.html" title="Tool for controlling a texture renderer to generate animations. ">oficina::ofAnimator</a> component. </td></tr>
    <tr><td class="paramname">speed</td><td>Numeric value for the animation speed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h4><a class="anchor" id="ofluaSETANIMRUN"></a>
setRunning</h4>
<div class="fragment"><div class="line">render.animator.setRunning(animator, state)</div></div><!-- fragment --><p> Sets the current playing state of the animation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">animator</td><td>Reference to an <a class="el" href="classoficina_1_1of_animator.html" title="Tool for controlling a texture renderer to generate animations. ">oficina::ofAnimator</a> component. </td></tr>
    <tr><td class="paramname">state</td><td>New playing state of the animation. Can be true or false. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h4><a class="anchor" id="ofluaSETANIMPOS"></a>
setPosition</h4>
<div class="fragment"><div class="line">render.animator.setPosition(animator, position)</div></div><!-- fragment --><p> Sets the animation position related to the parent entity's matrix. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">animator</td><td>Reference to an <a class="el" href="classoficina_1_1of_animator.html" title="Tool for controlling a texture renderer to generate animations. ">oficina::ofAnimator</a> component. </td></tr>
    <tr><td class="paramname">position</td><td>Table containing two numeric values, with the new relative position for the animation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None (void).</dd></dl>
<h4><a class="anchor" id="ofluaGETANIMSPD"></a>
getSpeed</h4>
<div class="fragment"><div class="line">render.animator.getSpeed(animator)</div></div><!-- fragment --><p> Gets the current animation speed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">animator</td><td>Reference to an <a class="el" href="classoficina_1_1of_animator.html" title="Tool for controlling a texture renderer to generate animations. ">oficina::ofAnimator</a> component. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A numeric value representing the current animation speed.</dd></dl>
<h4><a class="anchor" id="ofluaGETANIMDEFSPD"></a>
getDefaultSpeed</h4>
<div class="fragment"><div class="line">render.animator.getDefaultSpeed(animator)</div></div><!-- fragment --><p> Gets the default animation speed, defined when the animation was registered. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">animator</td><td>Reference to an <a class="el" href="classoficina_1_1of_animator.html" title="Tool for controlling a texture renderer to generate animations. ">oficina::ofAnimator</a> component. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A numeric value representing the default animation speed.</dd></dl>
<h4><a class="anchor" id="ofluaANIMPOS"></a>
getPosition</h4>
<div class="fragment"><div class="line">render.animator.getPosition(animator)</div></div><!-- fragment --><p> Gets the current position of the animation related to the parent entity's matrix. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">animator</td><td>Reference to an <a class="el" href="classoficina_1_1of_animator.html" title="Tool for controlling a texture renderer to generate animations. ">oficina::ofAnimator</a> component. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A table with two numeric values, representing X and Y coordinates of the animation related to the matrix.</dd></dl>
<h4><a class="anchor" id="ofluaANIMRUNNING"></a>
isRunning</h4>
<div class="fragment"><div class="line">render.animator.isRunning(animator)</div></div><!-- fragment --><p> Gets whether the animation is currently running. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">animator</td><td>Reference to an <a class="el" href="classoficina_1_1of_animator.html" title="Tool for controlling a texture renderer to generate animations. ">oficina::ofAnimator</a> component. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Boolean true or false representing the current playing state of the animation.</dd></dl>
<h4><a class="anchor" id="ofluaANIMNAME"></a>
getName</h4>
<div class="fragment"><div class="line">render.animator.getName(animator)</div></div><!-- fragment --><p> Gets the name of the currently playing animation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">animator</td><td>Reference to an <a class="el" href="classoficina_1_1of_animator.html" title="Tool for controlling a texture renderer to generate animations. ">oficina::ofAnimator</a> component. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A string containing the name of the animation which is currently being played.</dd></dl>
<h1><a class="anchor" id="luausage"></a>
Usage Guide</h1>
<h2><a class="anchor" id="luabasic"></a>
Basic Example</h2>
<p>Every script needs two global functions, which will be exported to the Lua object: init() and update(dt). Below is an example of an empty script with those requirements:</p>
<div class="fragment"><div class="line">function init()</div><div class="line">    -- Your code here</div><div class="line">end</div><div class="line"></div><div class="line">function update(dt)</div><div class="line">    -- Your code here</div><div class="line">end</div></div><!-- fragment --><p>The reason for those functions is that, any time your script is loaded, everything is evaluated. This is why you must encapsulate your code inside functions, so the whole code is not executed at once. Also, there is no requirement for importing Oficina's libraries: those are already defined and will only need their prefixes for acessing its fields and values.</p>
<h2><a class="anchor" id="luacomplex"></a>
A More Complex Example</h2>
<p>You can, though, predefine some (local or global) variables or functions outside of the predefined ones for later use. The following example will rotate a specific object by 0.5rad per second in the Z axis:</p>
<div class="fragment"><div class="line">local rotationSpeed = 0.5</div><div class="line"></div><div class="line">function init()</div><div class="line">    -- Your code here</div><div class="line">end</div><div class="line"></div><div class="line">function update(dt)</div><div class="line">    entity.rotate((rotationSpeed * dt),</div><div class="line">                  {0.0, 0.0, 1.0},</div><div class="line">                  false)</div><div class="line">end</div></div><!-- fragment --><p>Notice that, in the first line of code, we define a global object variable called rotationSpeed. The "local" keyword ensures that this variable is not accessible from outside the script object, so it cannot be fetched by C++ code.</p>
<p>By multiplying rotationSpeed by dt, dwe ensure that the current frame's rotation is corrected so each second spins our object by 0.5rad. dt represents the Delta-Time, which is the amount of time, in seconds (as a numeric real value) the game has taken to get from the last frame to the current frame. If we did not correct our rotation speed on a per-frame basis, the object would spin 0.5rad PER FRAME. That could be dangerous if you're not purposely limiting your frame rate; your game could run at less than 30 or at much more than 1000 frames per second! To better understand that, you can remove the speed correction and try disabling and enabling VSync on Oficina to spot the difference.</p>
<h1><a class="anchor" id="lualuaexample"></a>
IronLua Example</h1>
<p>The example below defines a behaviour for an object called MyObject.</p>
<div class="fragment"><div class="line">-- MyObject.lua</div><div class="line">-- Oficina Lua Script file for class MyObject</div><div class="line"></div><div class="line">-- Default movement speed for object</div><div class="line">local spd        = 300.0</div><div class="line">-- Default scaling speed for object</div><div class="line">local scaleSpeed = 10.0</div><div class="line"></div><div class="line">-- Keeps track of object&#39;s magnification on X</div><div class="line">-- and Y axis</div><div class="line">local xMag       = 1.0</div><div class="line">local yMag       = 1.0</div><div class="line"></div><div class="line">-- This variable will hold a reference to the</div><div class="line">-- component which executes this script</div><div class="line">local thisComponent = nil</div><div class="line"></div><div class="line">-- Helper function to clamp a value to a minimum and a maximum value</div><div class="line">local function clamp(value, min, max)</div><div class="line">    if     (value &lt; min) then return min</div><div class="line">    elseif (value &gt; max) then return max end</div><div class="line">    return value</div><div class="line">end</div><div class="line"></div><div class="line">-- Helper function to display stuff on REPL</div><div class="line">local function printObjectProperties()</div><div class="line">    common.clear()</div><div class="line">    common.format(&quot;Entity:               %s\n&quot;, this)</div><div class="line">    common.format(&quot;Component:            %s\n&quot;, thisComponent)</div><div class="line">    common.format(&quot;Component Type:       %s\n&quot;, entity.componentType(thisComponent))</div><div class="line">    common.format(&quot;Is a Lua script?      %s\n&quot;,</div><div class="line">            (entity.componentType(thisComponent) == &quot;oficina::ofLua&quot;))</div><div class="line">    common.format(&quot;\n&quot;)</div><div class="line"></div><div class="line">    -- Show player stuff</div><div class="line">    common.format(&quot;Object Position:      %f, %f\n&quot;,</div><div class="line">            entity.getPosition()[X], entity.getPosition()[Y])</div><div class="line">    common.format(&quot;Object Rotation:      %f\n&quot;, entity.getEulerAngle(Z))</div><div class="line">    common.format(&quot;Object Magnification: %0.2fx%0.2fx%0.2f\n&quot;,</div><div class="line">            entity.getMagnification(X), entity.getMagnification(Y),</div><div class="line">            entity.getMagnification(Z))</div><div class="line">    common.format(&quot;Object Property Mask: %s\n&quot;, common.hex(entity.getPropertyMask()))</div><div class="line">end</div><div class="line"></div><div class="line">-- Initialization function</div><div class="line">function init()</div><div class="line">    -- Define three properties for example</div><div class="line">    entity.setProperty(2, true)</div><div class="line">    entity.setProperty(32, true)</div><div class="line">    entity.setProperty(31, true)</div><div class="line"></div><div class="line">    -- Set initial angle</div><div class="line">    entity.rotate(0.0, {0.0, 0.0, 1.0}, true)</div><div class="line"></div><div class="line">    -- Set initial position</div><div class="line">    entity.translate({600.0, 400.0, 0.0}, true)</div><div class="line"></div><div class="line">    -- Retrieve reference to component</div><div class="line">    thisComponent = entity.getComponent(&quot;Lua&quot;)</div><div class="line">end</div><div class="line"></div><div class="line"></div><div class="line">-- Update function</div><div class="line">function update(dt)</div><div class="line">    -- Rotate object</div><div class="line">    entity.rotate((0.5 * dt), {0.0, 0.0, 1.0})</div><div class="line"></div><div class="line">    -- Magnify/minify object according to</div><div class="line">    -- right stick input</div><div class="line">    local rstk = common.rstick()</div><div class="line">    xMag = xMag + (rstk[X] * dt)</div><div class="line">    yMag = yMag + (rstk[Y] * dt)</div><div class="line">    xMag = clamp(xMag, 0.5, 2.0)</div><div class="line">    yMag = clamp(yMag, 0.5, 2.0)</div><div class="line">    entity.scale({xMag, yMag, 1.0}, true)</div><div class="line"></div><div class="line">    -- Toggle property #10 when pressing B button</div><div class="line">    if common.btntap(PAD_B) then</div><div class="line">        entity.toggleProperty(11)</div><div class="line">    end</div><div class="line"></div><div class="line">    -- Translate object according to stick</div><div class="line">    local lstk = common.lstick()</div><div class="line">    entity.translate({lstk[X] * spd * dt,</div><div class="line">                      lstk[Y] * spd * dt,</div><div class="line">                      0.0})</div><div class="line"></div><div class="line">    -- Print object info</div><div class="line">    printObjectProperties()</div><div class="line">end</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Apr 26 2017 17:02:15 for OficinaFramework by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
